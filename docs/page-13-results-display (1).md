# 13. 結果表示ページ

## 概要

クイズ受験後の結果を表示するページ。スコア、正誤情報、解説、合格/不合格の判定、証明書発行などの機能を提供する。

## ページ構成

1. **結果サマリーセクション**

   - 合格/不合格表示（大きく視覚的に）
   - 総合スコア（正答率）
   - 獲得点数/満点
   - 所要時間
   - クイズ名と説明

2. **スコアグラフ**

   - 円グラフまたはゲージチャート（正答率）
   - セクション別スコア（セクションがある場合）
   - 平均スコアとの比較（オプション）

3. **問題レビュー**

   - 全問題のリスト表示
   - 各問題の正誤表示
   - 問題ごとの詳細表示
     - 問題文
     - 提出した回答
     - 正解
     - 解説
     - 参考リンク（オプション）

4. **合格証セクション**（プロプラン、合格時のみ）

   - 合格証プレビュー
   - ダウンロードボタン（PDF）
   - メール送信オプション
   - ソーシャル共有ボタン

5. **おすすめアクション**

   - 「もう一度挑戦」ボタン
   - 「他のクイズを探す」リンク
   - 「結果を共有」オプション
   - 「学習リソース」リンク（オプション）

6. **詳細分析**（プロプラン）

   - カテゴリー/タグ別の強み/弱み分析
   - 時間配分分析
   - 改善提案

7. **フィードバックセクション**
   - クイズ評価（星評価）
   - フィードバックコメント入力
   - 報告機能（問題に関する問題点など）

## 技術仕様

- **コンポーネント構成**

  - `ResultSummary.tsx`
  - `ScoreChart.tsx`
  - `QuestionReviewList.tsx`
  - `QuestionReviewItem.tsx`
  - `CertificateDisplay.tsx`
  - `RecommendedActions.tsx`
  - `DetailedAnalysis.tsx`
  - `FeedbackForm.tsx`

- **状態管理**

  - `useResultStore.ts` - Zustandストア
    - 表示フィルター（全問/正解のみ/不正解のみ）
    - 現在開いている問題の詳細
    - フィードバック状態
  - TanStack Query
    - 結果データ取得
    - 証明書生成状態

- **データ可視化**

  - Recharts または Chart.jsを使用
  - アニメーションスコア表示
  - インタラクティブグラフ

- **証明書生成**

  - PDFフォーマット
  - カスタムテンプレート（プロプラン）
  - 固有ID/QRコードによる検証機能

- **結果共有機能**

  - ソーシャルメディア共有
  - メール送信
  - 結果URLの生成（保護オプション付き）

- **API連携**

  - 結果データ取得: `/api/results/:resultId`
  - 証明書生成: `/api/results/:resultId/certificate`
  - フィードバック送信: `/api/results/:resultId/feedback`
  - 結果共有: `/api/results/:resultId/share`

- **プリント最適化**

  - 印刷用スタイル
  - PDF出力最適化

- **レスポンシブ設計**
  - モバイル: 単一カラム、アコーディオン形式の問題リスト
  - タブレット: 2カラムレイアウト、サイドバーナビゲーション
  - デスクトップ: 複数カラムレイアウト、詳細情報の同時表示

## Next.js移行考慮事項

- 結果データの取得はServer Componentで実装
- インタラクティブな要素（問題詳細の展開/折りたたみなど）はクライアントコンポーネント化
- 証明書生成とプレビューはServer Actionとして実装
- PDF生成はAPI Routesとして実装
- 結果共有機能はServer Actionとして実装
