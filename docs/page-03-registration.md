# 3. 登録ページ

## 概要

新規ユーザーがアカウントを作成し、テナント（組織）を設定するためのページ。

## ページ構成

1. **ステップインジケーター**

   - マルチステップフォームの進行状況を表示
   - 「アカウント情報」→「組織設定」→「プラン選択」→「完了」

2. **ステップ1: アカウント情報**

   - メールアドレス入力
   - パスワード設定（強度インジケーター付き）
   - 名前（姓・名）入力
   - 利用規約・プライバシーポリシー同意チェックボックス
   - 「次へ」ボタン
   - ソーシャルログインオプション（Google, GitHub）

3. **ステップ2: 組織設定**

   - 組織名入力
   - サブドメイン選択（入力フィールドで利用可能かリアルタイムチェック）
   - 組織規模選択（ドロップダウン）
   - 業種選択（ドロップダウン）
   - 「次へ」ボタン

4. **ステップ3: プラン選択**

   - シンプルなプラン選択（フリー/プロ/エンタープライズ）
   - プロプランを選択した場合：
     - カード情報入力
     - 請求住所入力
   - 「完了」ボタン

5. **完了ステップ**

   - 成功メッセージ
   - アカウント確認のためメールを確認するよう案内
   - ダッシュボードへの「開始する」ボタン

6. **サイドセクション**
   - 登録の利点を説明
   - サービスのスクリーンショットまたはイラスト

## 技術仕様

- **コンポーネント構成**

  - `StepIndicator.tsx`
  - `AccountForm.tsx`
  - `OrganizationForm.tsx`
  - `PlanSelectionForm.tsx`
  - `PaymentForm.tsx`
  - `RegistrationSuccess.tsx`

- **状態管理**

  - `useRegistrationStore.ts` - Zustandストア
    - 現在のステップ
    - フォームデータ
    - エラー状態

- **フォームバリデーション**

  ```typescript
  const accountSchema = z.object({
    email: z.string().email('有効なメールアドレスを入力してください'),
    password: z.string().min(8, 'パスワードは8文字以上必要です'),
    firstName: z.string().min(1, '名を入力してください'),
    lastName: z.string().min(1, '姓を入力してください'),
    agreeToTerms: z.literal(true, {
      errorMap: () => ({ message: '利用規約に同意する必要があります' }),
    }),
  });

  const organizationSchema = z.object({
    name: z.string().min(2, '組織名は2文字以上必要です'),
    subdomain: z
      .string()
      .min(3, 'サブドメインは3文字以上必要です')
      .regex(/^[a-z0-9-]+$/, '小文字、数字、ハイフンのみ使用可能です'),
    size: z.enum(['1-10', '11-50', '51-200', '201-500', '501+']),
    industry: z.string().min(1, '業種を選択してください'),
  });
  ```

- **API連携**

  - サブドメイン利用可能チェック: `/api/check-subdomain`
  - アカウント登録: `/api/register`
  - Stripe決済連携: `/api/create-subscription`

- **レスポンシブ設計**
  - モバイル: フォームとステップインジケーターのみ、サイドセクション非表示
  - タブレット/デスクトップ: フォームとサイドセクションの2カラムレイアウト

## Next.js移行考慮事項

- フォームコンポーネントはクライアントコンポーネント化
- サブドメインチェックはServer Action化
- 登録処理全体はServer Action化
- Clerk認証への統合
